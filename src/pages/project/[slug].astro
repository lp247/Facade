---
import {getCollection, type CollectionEntry} from "astro:content";
import Standard from "@layouts/Standard.astro";
import TechBadgeList from "@components/TechBadgeList.astro";
import ProjectStatus from "@components/ProjectStatus.astro";
import ExternalLink from "@components/ExternalLink.astro";

export async function getStaticPaths() {
    const entries = await getCollection("project");
    return entries.map((entry) => ({
        params: {slug: entry.slug},
        props: {entry},
    }));
}

interface Props {
    entry: CollectionEntry<"project">;
}

const {entry} = Astro.props as Props;
const {Content} = await entry.render();
const {github, webpage, techs, year, name, summary, headline, status} = entry.data;
---

<Standard heading={name} subheading={headline}>
    <hr class="mb-4 mt-4" />
    <div class="flex row mb-4 gap-4 items-center">
        <span class="font-sans text-sm font-bold">{year}</span>
        <span>|</span>
        <ProjectStatus status={status} />
    </div>
    <TechBadgeList techs={techs.map((tech) => tech.id)} />
    <div class="flex row mt-4 gap-4 items-center">
        {
            github && (
                <ExternalLink class="mt-4" href={github}>
                    Code on GitHub
                </ExternalLink>
            )
        }
        {
            webpage && (
                <ExternalLink class="mt-4" href={webpage}>
                    Link to page
                </ExternalLink>
            )
        }
    </div>
    <hr class="my-4" />
    <p>{summary}</p>
    <hr class="my-4" />
    <Content />
</Standard>
